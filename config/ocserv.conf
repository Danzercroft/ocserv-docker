# OCServ Configuration
# Static configuration file for OCServ VPN Server

# Основная конфигурация ocserv
auth = "plain[passwd=@PASSWD_PATH@]"
tcp-port = 443
udp-port = 443
run-as-user = nobody
run-as-group = daemon
socket-file = /var/run/ocserv-socket

# Сертификаты (пути заменяются переменными окружения в entrypoint.sh)
server-cert = @SERVER_CERT_PATH@
server-key = @SERVER_KEY_PATH@

# Максимальное количество клиентов
max-clients = 128
max-same-clients = 10

server-stats-reset-time = 604800

# Время жизни сессии
keepalive = 30
dpd = 60
mobile-dpd = 300

switch-to-tcp-timeout = 25
try-mtu-discovery = true

cert-user-oid = 0.9.2342.19200300.100.1.1

no-compress-limit = 256

auth-timeout = 240

min-reauth-time = 300

max-ban-score = 80

ban-reset-time = 300

cookie-timeout = 300

deny-roaming = false

rekey-time = 172800

rekey-method = ssl

predictable-ips = true

# Сеть VPN
ipv4-network = 10.10.10.0
ipv4-netmask = 255.255.255.0
ipv6-network = fda9:4efe:7e3b:03ea::/48
ipv6-subnet-prefix = 64

tunnel-all-dns = true

# DNS серверы
dns = 8.8.8.8
dns = 1.1.1.1

ping-leases = false

# Скрипты подключения/отключения
#connect-script = /usr/bin/ocserv-script
#disconnect-script = /usr/bin/ocserv-script

# Логирование
use-occtl = true
pid-file = /var/run/ocserv.pid
log-level = 1
device = vpns

# Отключение legacy SSL
tls-priorities = "NORMAL:%SERVER_PRECEDENCE:%COMPAT:-RSA:-VERS-SSL3.0:-ARCFOUR-128"

# Компрессия
compression = true

# Совместимость с AnyConnect клиентами
cisco-client-compat = true

# Настройки для мобильных устройств
mobile-dpd = 1800
stats-report-time = 360

